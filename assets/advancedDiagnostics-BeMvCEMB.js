const se=r=>{var L;const e=[],{vram:t,cores:s,ramCap:o,estimatedLoad:i,wattage:d,tdpCpu:c,gpuPower:u,cooling:n,storage:l,cpuName:p,gpuName:B,ramName:G,ramSpeed:k,ramSticks:v,motherboardChipset:a,motherboardModel:W,maxBoardRamSpeed:U,pcieGen:S,gpuSlotLanes:I,nvmeSlots:C,ambientTemp:w,caseAirflow:A,caseFans:te,caseModel:ie,usbDevices:D,displays:x,gpuPorts:F}=r;t>=16&&s<8&&e.push("ADV: High-end GPU may be CPU-limited in simulation / strategy titles; consider 10–12 core CPU for frame time stability."),o>=128&&s<12&&e.push("ADV: Extreme RAM capacity without high core count – heavy parallel workloads will cap at CPU threads first."),i>0&&i<.35&&e.push(`ADV: PSU typical load ~${Math.round(i*100)}% – downsizing could improve efficiency curve & acoustics.`),i>.8&&e.push(`ADV: PSU headroom tight (~${Math.round(i*100)}%). Future GPU upgrades or transient spikes may stress rails.`),(n==null?void 0:n.type)==="Air"&&s>=16&&e.push("ADV: Air cooling on many-core CPU – sustained multi-hour renders may throttle; 360mm AIO or premium dual-tower advised."),l||e.push("ADV: No storage selected – choose fast NVMe for OS & primary workloads."),(L=l==null?void 0:l.interface)!=null&&L.includes("SATA")&&t>=12&&e.push("ADV: SATA SSD in performance build; Gen4 NVMe reduces asset streaming latency & compile times."),o>=64&&t<10&&e.push("ADV: High memory with modest GPU – for graphical workloads upgrade GPU before expanding RAM further."),o===16&&t>=12&&e.push("ADV: 16GB may constrain large texture packs / editing sessions; 32GB recommended."),o>=96&&((l==null?void 0:l.capacity)??0)<1e3&&e.push("ADV: Very high RAM but limited storage – larger NVMe improves scratch/project utilisation of memory caching."),d&&c+u>d-120&&e.push("ADV: PSU transient headroom limited – next wattage tier increases stability.");const y=typeof k=="number"&&k>0?k:K(G),H=typeof v=="number"&&v>0?v:Z(G),M=typeof S=="number"&&S>0?S:q(a),$=Y(B,t);H===1&&o>=16&&e.push(`ADV: ⚠️ CRITICAL – Single-channel RAM detected (1x${o}GB). Expect 15–30% performance loss in CPU/memory-bound tasks. Use 2x${Math.max(4,Math.floor(o/2))}GB for dual-channel (same cost, double bandwidth).`),H===4&&o<=32&&e.push("ADV: 4x DIMMs on consumer dual‑channel platform offers no bandwidth gain vs 2x higher‑capacity sticks and can reduce achievable RAM speed; prefer 2x modules for stability and future upgrades."),p&&/ryzen\s*(7|9)\d{3}/i.test(p)&&y&&y<6e3&&e.push(`ADV: Ryzen DDR5 sweet spot is 6000 MT/s (1:1 IF). Your RAM speed ${y} is suboptimal; 6000 CL30 typically yields +5–8% CPU‑bound uplift.`),typeof U=="number"&&y&&y>U&&e.push(`ADV: RAM ${y} MT/s exceeds motherboard validated max ${U} MT/s – kit may run downclocked; consider matching speed to QVL.`),$==="flagship"&&M&&M<=3?e.push(`ADV: ⚠️ PCIe 3.0 may bottleneck a flagship GPU – expect 8–12% FPS loss vs PCIe 4.0 in bandwidth‑heavy titles. Consider a PCIe 4.0 motherboard for ${B??"GPU"}.`):$==="high-end"&&M&&M<=3&&e.push("ADV: PCIe 3.0 with a high‑end GPU can cost ~3–5% performance; acceptable on a budget but suboptimal for £500+ GPUs."),typeof I=="number"&&I===8&&$!=="budget"&&e.push("ADV: GPU appears limited to PCIe x8 – verify slot choice and M.2 lane sharing; x8 can reduce performance 2–8% on upper‑tier GPUs."),typeof C=="number"&&C>=2&&typeof a=="string"&&/B550/i.test(a)&&e.push(`ADV: ${a} lane‑sharing note – second M.2 slot can disable SATA ports or reduce GPU to x8; check manual for optimal slot placement.`),a&&(/ryzen\s*7\d{3}/i.test(p??"")&&/B550|X570/i.test(a)&&e.push(`ADV: Platform mismatch risk – ${p??"CPU"} (AM5) requires B650/X670 series. ${W??a} is likely AM4.`),/H610/i.test(a)&&(c>=125||s>=8)&&e.push(`ADV: ${a} chipset is entry‑level – limited features (no OC/XMP on some boards, fewer lanes). Consider B660/B760 or Z790 for ${p??"CPU"} to avoid platform constraints.`));const m=_(n==null?void 0:n.type,n==null?void 0:n.name),N=j(n==null?void 0:n.name),V=(c||0)+(u||0);m==="Stock"&&c>=95&&e.push(`ADV: ⚠️ THERMAL – Stock cooler with ${c}W CPU will run at or near thermal limits under load (90–100°C). Recommend a tower air cooler or 240mm+ AIO.`),m==="Low Profile"&&c>=95&&e.push(`ADV: Low‑profile cooler is marginal for ${c}W CPU; expect high temps in sustained loads. Ensure case clearance for a taller tower or consider 240mm AIO.`);const O=N??0;m==="AIO"&&O>0&&O<=240&&c>=170&&e.push(`ADV: 240mm AIO is minimal for ${c}W class CPUs; consider 280/360mm for better sustained thermals (5–10°C cooler under all‑core workloads).`),A==="Poor"&&V>400&&e.push(`ADV: Case airflow rated poor for ~${V}W system; add intake/exhaust fans or choose a mesh‑front case to avoid heat soak and throttling.`),(!A||A==="Unknown"||A==="Adequate")&&u>=350&&e.push(`ADV: High‑power GPU (~${u}W) benefits from strong case airflow (2–3 front intakes, 1–2 exhaust). Expect higher internal temps without it.`),typeof w=="number"&&w>25&&V>450&&e.push(`ADV: Ambient ${w}°C + ~${V}W system reduces thermal headroom; raise fan curves in summer or consider higher‑capacity cooling.`);const P=d>0?Math.max(0,1-(i||0))*100:void 0,g=(p??"").toLowerCase(),f=(a??"").toUpperCase();if(g&&!/\bk\b|\bx\b|x3d/.test(g)&&(f.startsWith("Z")||f.startsWith("X"))&&e.push(`ADV: Overclocking note – ${p} is locked (no ratio OC) on ${a}. You pay for OC features you can't fully use. Focus: RAM tuning, power limit/undervolt for efficiency.`),/\bk\b/.test(g)&&(f.startsWith("B")||f.startsWith("H"))&&e.push(`ADV: ${p} (unlocked) on ${a} restricts CPU ratio OC. Full OC requires Z‑series. You can still raise power limits and tune RAM.`),g.includes("x3d")&&e.push(`ADV: ${p} OC limitations – X3D has locked multipliers/voltages. Best gains from Curve Optimizer (negative offsets) and RAM tuning.`),/(\bk\b|\bx\b)/.test(g)&&(f.startsWith("Z")||f.startsWith("X"))&&(m==="AIO"||m==="Air")&&(P??0)>=25&&e.push(`ADV: ✅ Strong OC foundation – Unlocked CPU on ${a} with adequate cooling and ~${Math.round(P)}% PSU headroom. Expect modest gains (5–12% multi‑core with voltage increases; memory tuning improves 1% lows).`),(P??0)>0&&(P??0)<20&&(/(\bk\b|\bx\b)/.test(g)||m!=="Unknown")&&e.push(`ADV: ⚠️ OC headroom limited – PSU margin ~${Math.round(P)}%. Overclocking raises power draw and transient spikes; keep tuning conservative or upgrade PSU.`),(f.startsWith("B")||f.startsWith("H"))&&/intel|i\d-\d{4,}/i.test(p??"")&&e.push(`ADV: Intel tuning on ${a}: CPU ratio OC is locked, but raising power limits (PL1/PL2) and enabling XMP can boost sustained clocks. Monitor temps when lifting limits.`),/A620/i.test(a??"")?e.push(`ADV: ${a} is entry‑level AM5 – limited CPU OC controls; PBO/Curve Optimizer may be restricted depending on board. Focus on EXPO memory tuning for gains.`):/B650|X670/i.test(a??"")&&e.push("ADV: AMD OC guidance – Enable PBO/Curve Optimizer for efficient boosts; keep SoC voltage conservative (≤1.30–1.35V). EXPO at DDR5‑6000 is ideal for Ryzen 7000/9000."),/\b14900k\b|\b13900k\b|\b13700k\b/i.test(g)&&m==="Air"&&e.push("ADV: High‑power Intel K‑series on air cooling can hit thermal limits under all‑core loads; consider strong dual‑tower or a 280/360mm AIO for sustained OC."),Array.isArray(D)&&D.length>0){const h=Q(D);e.push(...h)}if(Array.isArray(x)&&x.length>0){const h=J(x,F??[]);e.push(...h)}if(l){const h=(l.interface||"").toLowerCase(),R=(l.name||"").toLowerCase(),z=l.readSpeed,b=ee(h,R,z),T=!!l.heatsink||/heatsink|heat\s*sink|with\s*heatsink/.test(R),X=typeof w=="number"&&w>25,E=A==="Poor"||A==="Unknown";(b===4||b===5)&&!T&&e.push(`ADV: NVMe Gen${b} without a heatsink is prone to thermal throttling under sustained transfers. Use the motherboard M.2 shield or an aftermarket heatsink and ensure some airflow across the M.2 area.`),b===5&&(z||0)>=9e3&&(X||E)&&e.push("ADV: Gen5 NVMe at very high speeds in warm/low‑airflow cases can throttle during long installs/exports. A finned heatsink with directed airflow helps sustain performance."),typeof C=="number"&&C>=2&&(b===4||b===5)&&e.push(`ADV: Multiple Gen${b} NVMe drives raise motherboard hotspot temps; avoid stacking both under the GPU and provide strong front‑intake airflow.`)}if(Array.isArray(D)&&D.some(h=>(h||"").toLowerCase().includes("audio interface"))&&e.push("ADV: USB audio best practices – use a rear USB 3.x Type‑A port on a separate controller if available, avoid front‑panel hubs, prefer a powered hub for stability, and route audio cables away from GPU/PSU runs."),u>=350){const h=typeof i=="number"&&i>0?Math.round(i*100):void 0;typeof h=="number"&&(i<.35||i>.85)?e.push(`ADV: High‑power GPUs can exhibit coil whine; current PSU load ~${h}%. Mitigations: cap FPS or enable V‑Sync/G‑Sync, try light GPU undervolting, and aim for a 40–70% PSU load range during gaming.`):e.push("ADV: High‑power GPUs can exhibit coil whine at very high FPS. Mitigations: cap FPS or enable V‑Sync/G‑Sync and try light undervolting; coil whine typically decreases under steadier loads.")}return e};function K(r){if(!r)return;const e=r.toLowerCase(),t=e.match(/ddr\d[-\s]?([0-9]{3,5})/i);if(t&&t[1])return parseInt(t[1],10);const s=e.match(/([0-9]{3,5})\s*mhz/);if(s&&s[1])return parseInt(s[1],10)}function Z(r){if(!r)return;const e=r.toLowerCase().match(/(\d)\s*x\s*\d+\s*gb/);if(e&&e[1])return parseInt(e[1],10)}function q(r){if(!r)return;const e=r.toUpperCase();if(/B450|X470|Z390|H370|B365|B360/.test(e))return 3;if(/B550|X570|Z490|Z590|B560|H570/.test(e))return 4;if(/B650E|X670E/.test(e))return 5;if(/B650|X670|Z690|Z790|B660|B760/.test(e))return 4}function Y(r,e){const t=(r??"").toLowerCase();return t.includes("4090")||t.includes("7900 xtx")||(e??0)>=22?"flagship":t.includes("4080")||t.includes("4070 ti")||t.includes("7900 xt")||(e??0)>=16?"high-end":t.includes("4070")||t.includes("7800 xt")||t.includes("7700 xt")?"mid-range":"budget"}function _(r,e){const t=(r??"").toLowerCase(),s=(e??"").toLowerCase();return t.includes("aio")||s.includes("aio")||s.includes("liquid")||s.includes("water")?"AIO":t.includes("air")||s.includes("air")||s.includes("tower")||s.includes("nh-d15")||s.includes("assassin")?"Air":t.includes("low")||s.includes("low profile")||s.includes("lp")?"Low Profile":t.includes("stock")||s.includes("stock")?"Stock":"Unknown"}function j(r){if(!r)return;const e=r.toLowerCase().match(/(120|240|280|360|420)\s*mm/);if(e&&e[1])return parseInt(e[1],10);const t=r.toLowerCase().match(/\b(120|240|280|360|420)\b/);if(t&&t[1])return parseInt(t[1],10)}function Q(r){const e=[],t=r.map(i=>(i||"").toLowerCase()),s=t.filter(i=>i.includes("capture")||i.includes("external ssd")||i.includes("webcam 4k")||i.includes("audio interface"));s.length>=2&&e.push(`ADV: USB bandwidth congestion risk – ${s.length} high‑bandwidth devices detected (capture/SSD/4K webcam/audio). Spread across different controllers; prefer 10–20Gbps ports for capture/SSD.`);const o=t.filter(i=>i.includes("keyboard")||i.includes("mouse")||i.includes("dongle")||i.includes("rgb"));return o.length>=6&&e.push(`ADV: Many low‑speed USB devices (${o.length}) can cause polling/latency conflicts on shared hubs. Place high‑polling peripherals on USB 3.0 ports or a separate controller.`),e}function J(r,e){const t=[],s=e.map(i=>(i||"").toLowerCase());r.forEach((i,d)=>{const c=(i.resolution||"").toLowerCase(),u=(i.connection||"").toLowerCase(),n=i.refreshRate||60;c.includes("3840x2160")&&n>=120&&u.includes("hdmi 2.0")&&t.push(`ADV: Monitor ${d+1}: 4K ${n}Hz needs HDMI 2.1 or DP 1.4+. HDMI 2.0 caps at 4K60.`),c.includes("3840x2160")&&n>=120&&u.includes("hdmi 2.1")&&t.push(`ADV: Monitor ${d+1}: For 4K ${n}Hz over HDMI 2.1, use an Ultra High Speed HDMI certified cable to avoid intermittent black screens.`),c.includes("3840x2160")&&n>=144&&u.includes("displayport 1.4")&&t.push(`ADV: Monitor ${d+1}: 4K ${n}Hz over DP 1.4 typically uses DSC; use a VESA‑certified DP 1.4 cable rated for HBR3 to ensure stability.`),c.includes("2560x1440")&&n>=240&&u.includes("hdmi 2.0")&&t.push(`ADV: Monitor ${d+1}: 1440p ${n}Hz requires DisplayPort 1.4; HDMI 2.0 is typically limited around 144Hz.`),c.includes("1920x1080")&&n>=240&&u.includes("hdmi 2.0")&&t.push(`ADV: Monitor ${d+1}: 1080p ${n}Hz is more reliable over DP 1.4; HDMI 2.0 support varies by monitor.`),c.includes("3440x1440")&&n>=170&&u.includes("hdmi 2.0")&&t.push(`ADV: Monitor ${d+1}: 3440×1440 ${n}Hz typically needs DP 1.4; HDMI 2.0 often caps lower.`)});const o=r.filter(i=>(i.resolution||"").includes("3840x2160")).length;return r.length>=3&&o>=2&&t.push("ADV: Multi‑4K setup – heavy display bandwidth can raise idle power and cause desktop stutter; enable DSC or reduce secondary monitors to 60Hz."),r.some(i=>(i.resolution||"").includes("3840x2160")&&(i.refreshRate||60)>=120)&&!s.some(i=>i.includes("hdmi 2.1")||i.includes("displayport 1.4"))&&t.push("ADV: GPU ports may limit high‑refresh 4K; ensure HDMI 2.1 or DP 1.4 ports and certified cables are used."),t}function ee(r,e,t){const s=(r||"").toLowerCase(),o=(e||"").toLowerCase();if(!(s.includes("sata")||o.includes("sata"))){if((s.includes("gen5")||s.includes("pci"))&&(s.includes("5.0")||o.includes("gen5")||o.includes("gen 5")))return 5;if(s.includes("gen4")||o.includes("gen4")||o.includes("gen 4"))return 4;if(s.includes("gen3")||o.includes("gen3")||o.includes("gen 3"))return 3;if(typeof t=="number"){if(t>=9e3)return 5;if(t>=5e3)return 4;if(t>=3e3)return 3}}}export{se as getAdvancedDiagnostics};
